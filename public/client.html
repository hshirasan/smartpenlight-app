<!DOCTYPE html>
<html>
<head>
  <title>Client Light</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      background: black;
      overflow: hidden;
    }
    #qr-container {
      position: absolute;
      top: 100px;
      left: 100px;
      width: 200px;
      height: 200px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 5px;
      display: none; /* 初期状態では非表示 */
      justify-content: center;
      align-items: center;
    }
    canvas {
      width: 180px;
      height: 180px;
    }
  </style>
</head>
<body>
  <div id="qr-container">
    <canvas id="qrcode"></canvas>
  </div>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script>
    const socket = io();
    const clientUrl = "http://192.168.11.10:3000/client";

    // QRコードを生成して表示
    const qrCanvas = document.getElementById('qrcode');
    QRCode.toCanvas(qrCanvas, clientUrl, { scale: 10, margin: 1 }, (error) => {
      if (error) console.error('Error generating QR code:', error);
      else console.log('QR code generated successfully');
    });

    // サーバーから点滅状態を受信
    socket.on('updateBlink', ({ isOn, color }) => {
      // 背景色を更新
      document.body.style.backgroundColor = isOn ? color : 'black';

      // QRコードの表示切り替え
      const qrContainer = document.getElementById('qr-container');
      if (isOn) {
        qrContainer.style.display = 'none'; // 点灯時は非表示
      } else {
        qrContainer.style.display = 'flex'; // 消灯時に表示
      }
    });
  </script>
</body>
</html>
